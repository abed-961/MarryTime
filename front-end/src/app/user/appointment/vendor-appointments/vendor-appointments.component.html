<section class="vendor-appointments section ">
    <div class="vendor-title-btn-container">
        <h2>Appointments Received</h2>
    </div>

    <!-- Loading / Error States -->
    <div *ngIf="loading" class="loading">Loading...</div>
    <div *ngIf="error" class="error">{{ error }}</div>

    <!-- Appointments Table -->
    <table *ngIf="!loading && appointments.length" class="appointments-table section">
        <thead>
            <tr>
                <th>appointment</th>
                <th>Vendors</th>
                <th>Date</th>
                <th>Location</th>
                <th>Guests</th>
                <th>Tables</th>
                <th>Status</th>
                <th>action</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let a of appointments; index as i" (click)="sendToVendors(a)">

                <td>{{i + 1}}</td>

                <!-- Vendors List as Table -->
                <td>
                    <table class="nested-vendors-table">
                        <thead>
                            <tr>
                                <th>Photo</th>
                                <th>Company</th>
                                <th>name</th>
                                <th>Location</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let v of a.vendors">
                                <td>
                                    <img *ngIf="v.user?.photo" [src]="photoUrl + v.user.photo" [alt]="v.user?.name"
                                        class="vendor-photo" />
                                    <div *ngIf="!v.user?.photo" class="vendor-photo-placeholder">
                                        {{ v.user?.name ? v.user.name[0] : '?' }}
                                    </div>
                                </td>
                                <td>{{ v.company_name }}</td>
                                <td>{{ v.user?.name }}</td>
                                <td>{{ v.location }}</td>
                            </tr>
                        </tbody>
                    </table>
                </td>


                <td>{{ a.appointment_date | date: 'mediumDate' }}</td>
                <td>{{ a.location }}</td>
                <td>{{ a.guests }}</td>
                <td>{{ a.tables }}</td>

                <td>
                    <span class="status" [ngClass]="getStatusClass(a.status)">
                        {{ a.status }}
                    </span>
                </td>

                <td><button class="btn btn-danger" (click)="refuseAppointment(a.id)"> Refuse </button></td>
            </tr>
        </tbody>
    </table>

    <div *ngIf="!loading && !appointments.length" class="empty">
        No appointments received yet.
    </div>
</section>